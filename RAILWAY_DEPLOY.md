# Deploying SuperAGI (ISHE Group) to Railway

This guide describes the minimal steps to deploy the project to Railway using Docker (recommended) or Railway's GitHub integration. It also explains the small helper scripts included to make Railway release-phase setup easier.

TL;DR
- Build the GUI as production (the repo includes a production `gui/Dockerfile` that runs `npm run build` and `npm start`).
- Ensure Railway environment variables (Postgres/Redis) are set or use Railway Plugins.
- Set Railway's release command to: `bash scripts/railway_release.sh`

1) Recommended: Docker deploy on Railway (best compatibility)

- Railway supports Docker-based deploys which mirror how you run locally with `docker compose`.
- Make sure your project has a Dockerfile at the repo root (this repo does).

2) Using Railway's GitHub integration (non-Docker)

- If you prefer Railway to build from source (non-Docker), you must ensure Railway provides build-time system deps (some Python packages require system libraries) or prefer the Docker approach.

3) Important env vars and helper scripts

- `scripts/railway_env_mapper.py` — reads Railway-provided variables (for example `DATABASE_URL` and `REDIS_URL`) and writes a `.env.generated` mapping file you can review and copy to `.env` if desired. During release the `railway_release.sh` script will call this mapper automatically.

- `scripts/railway_release.sh` — intended to be used as Railway's **Release Command**. The script will:
  - generate `.env.generated` from Railway envs (if present)
  - run DB migrations via `scripts/run_migrations.py` (alembic runner)
  - run `scripts/initialize_agent.py` to create a default agent

Recommended Railway settings
- Build command: (if using Docker, Railway will use the Dockerfile automatically)
- Release command: `bash scripts/railway_release.sh`
- Start command: leave empty if using Docker image that exposes a web process. If using Gunicorn/uvicorn non-Docker path, set `uvicorn main:app --host 0.0.0.0 --port $PORT`.

Local test commands

Build GUI production image locally (already validated in this Codespace):
```bash
cd /workspaces/SuperAGI/gui
docker build -t superagi-gui:prod .
```

Simulate Railway release locally:
```bash
cd /workspaces/SuperAGI
python3 scripts/railway_env_mapper.py   # creates .env.generated from current env
python3 scripts/run_migrations.py       # run alembic migrations (requires DATABASE_URL)
python3 scripts/initialize_agent.py     # create default agent
```

CI-driven deploy
- This repo contains a GitHub workflow `.github/workflows/deploy-to-railway.yml` which will attempt to use the Railway CLI when you provide `RAILWAY_API_TOKEN` and `RAILWAY_SERVICE_NAME` as repository secrets. If you prefer this path, add those secrets and push the branch.

Notes and troubleshooting
- If Python pip installs fail on Railway non-Docker builds, switch to Docker deploys — they are more reproducible because system-level build deps are available.
- Ensure `PORT`, `DATABASE_URL`, `REDIS_URL` (or equivalent DB_* variables) are set in Railway environment variables. The release script expects `DATABASE_URL` for migrations.

If you'd like, I can open a PR from a branch with these docs and the production GUI changes and attempt to push it so Railway/GitHub can build and deploy it. If pushing from this Codespace fails (no credentials), I'll provide exact `git` commands to run locally.

---
Generated by automation to help deploying to Railway. If you want a shorter README section instead, say so and I'll update `README.MD` instead.
